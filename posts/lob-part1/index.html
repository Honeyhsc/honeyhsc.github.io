<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><title>EDA - Order Book and Trades - Part 1 | Honey's Data Science Portfolio</title>
<meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="Exploratory analysis of L2 limit order book data to forecast trade prices."><meta name=generator content="Hugo 0.147.4"><meta name=robots content="index, follow"><meta name=author content="Honey"><link rel=stylesheet href=/ananke/css/main.min.d05fb5f317fcf33b3a52936399bdf6f47dc776516e1692e412ec7d76f4a5faa2.css><link rel=stylesheet href=/css/custom.css><link rel=canonical href=https://honeyhsc.github.io/posts/lob-part1/><meta property="og:url" content="https://honeyhsc.github.io/posts/lob-part1/"><meta property="og:site_name" content="Honey's Data Science Portfolio"><meta property="og:title" content="EDA - Order Book and Trades - Part 1"><meta property="og:description" content="Exploratory analysis of L2 limit order book data to forecast trade prices."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-05-13T01:47:30+01:00"><meta property="article:modified_time" content="2025-05-13T01:47:30+01:00"><meta itemprop=name content="EDA - Order Book and Trades - Part 1"><meta itemprop=description content="Exploratory analysis of L2 limit order book data to forecast trade prices."><meta itemprop=datePublished content="2025-05-13T01:47:30+01:00"><meta itemprop=dateModified content="2025-05-13T01:47:30+01:00"><meta itemprop=wordCount content="1642"><meta name=twitter:card content="summary"><meta name=twitter:title content="EDA - Order Book and Trades - Part 1"><meta name=twitter:description content="Exploratory analysis of L2 limit order book data to forecast trade prices."></head><body class="ma0 avenir bg-near-white production"><header class="cover bg-center" style=background-image:url(https://honeyhsc.github.io/images/background.jpg)><div class=bg-black-60><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l center items-center justify-between"><a href=/ class="f3 fw2 hover-white white-90 dib no-underline">Honey's Data Science Portfolio</a><div class="flex-l items-center"><ul class="pl0 mr3"><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white white-90 no-underline" href=/contact/ title="Contacts page">Contacts</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white white-90 no-underline" href=/posts/ title="Posts page">Posts</a></li></ul><div class=ananke-socials><a href=https://th.linkedin.com/in/honey-schauhan/ target=_blank rel=noopener class="ananke-social-link link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="follow on LinkedIn - Opens in a new window" aria-label="follow on LinkedIn - Opens in a new window"><span class=icon><svg viewBox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg>
</span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a></div></div></div></nav><div class="tc-l pv6 ph3 ph4-ns"><div class="f2 f1-l fw2 white-90 mb0 lh-title">EDA - Order Book and Trades - Part 1</div></div></div></header><main class=pb7 role=main><article class="flex-l mw8 center ph3 flex-wrap justify-between"><header class="mt4 w-100"><aside class="instapaper_ignoref b helvetica tracked ttu">Posts</aside><div id=sharing class="mt3 ananke-socials"></div><h1 class="f1 athelas mt3 mb1">EDA - Order Book and Trades - Part 1</h1><p class=tracked><strong>Honey</strong></p><time class="f6 mv4 dib tracked" datetime=2025-05-13T01:47:30+01:00>May 13, 2025</time></header><div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><h2 id=introduction>Introduction</h2><p>Trade Blog: Level 2 Data, Signals, and approach towards EDA</p><p>Recently, i had the opportunity to work on a complex project assigned by the Global AI/ML Lead of a well-known finance and investment bank. The goal was to implement data-analytics to identify trading signals(buy or sell) using the Level 2 trading data.</p><p>Stock exchanges publish a snapshot of currently received orders through &ldquo;Limit Order Book&rdquo; (LOB), which lists all outstanding buy and sell orders(limit) at each price level.
Each snapshot displays the total quantity available to buy or sell at each quoted price. At any given moment, the LOB typically contains dozens of (price, quantity) pairs, and it updates frequently—even before any actual trade occurs. Over a single trading day, this can result in <strong>over 100,000 data points</strong>. This high-resolution view of the market is what industry professionals refer to as <strong>Level 2 data</strong>.</p><p>When i began working on this project, all i knew is to perform EDA and then model, that limited understanding approaching a project like this(that can turn out to be a mammoth) resulting i a slow start with lot of back and forth(which is the story of any datascience project btw) but it could’ve been a little less painful and fast paced had i know a few broader principles of EDA in a trade environment setting.</p><p>In this blog, I’ll walk you through those principles—the hard-earned understanding that could save you time and rework. This post focuses on EDA, where we try to extract meaningful insights from the raw data that will inform the modeling phase (which I’ll cover in a follow-up post).</p><p>My EDA process starts by asking <strong>broad guiding questions</strong> and refining them as I learn more from the data. The idea is to examine all potentially relevant features without strong assumptions—because in our case, one wrong assumption ended up costing half the work to be redone. As with any good data science effort, our central question remains:</p><p>What in this data is signal—and what is just noise?</p><h3 id=dataset-overview>Dataset Overview:</h3><p>There were two set of data provided -</p><ol><li>Trade data: This captures executed transactions -</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span><span style=color:#66d9ef>-</span> <span style=color:#e6db74>`timestamp`</span>: The time at which the trade was executed.
</span></span><span style=display:flex><span><span style=color:#66d9ef>-</span> <span style=color:#e6db74>`price`</span>: Executed trade price.
</span></span><span style=display:flex><span><span style=color:#66d9ef>-</span> <span style=color:#e6db74>`volume`</span>: Number of stocks traded.
</span></span></code></pre></div><p>Here’s how the trade data snapshot looks -</p><table><thead><tr><th>timestamp</th><th>price</th><th>vol</th></tr></thead><tbody><tr><td>16.337</td><td>242</td><td>4</td></tr></tbody></table><ol start=2><li>Limit Order book(LoB)</li></ol><p>This records the state of the order book at specific times -</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span><span style=color:#66d9ef>-</span> <span style=color:#e6db74>`timestamp`</span>: The time at which the order was placed.
</span></span><span style=display:flex><span><span style=color:#66d9ef>-</span> <span style=color:#e6db74>`bid`</span>: A queue of limit bid orders(price, vol) at which the bids were placed.
</span></span><span style=display:flex><span><span style=color:#66d9ef>-</span> <span style=color:#e6db74>`ask`</span>: A queue of limit ask orders(price, vol) at which asks were placed in the order book.
</span></span></code></pre></div><p>Example LoB snapshot -</p><table><thead><tr><th>timestamp</th><th>exchange</th><th>bid</th><th>ask</th></tr></thead><tbody><tr><td>12.4</td><td>Exch0</td><td>[[236, 11], [219, 4]]</td><td>[[246, 2], [250, 4], [259, 1], [270, 1], [281, 2], [331, 2], [435, 4]]</td></tr></tbody></table><p>Both <code>bid</code> and <code>ask</code> queues are sorted: bids in <strong>descending price</strong> (best bid first), and asks in <strong>ascending price</strong> (best ask first). Each queue can go up to 15 levels deep. Data was collected daily for <strong>six months</strong>.</p><h3 id=eda->EDA :</h3><p>Lets first understand the scale we are dealing with -</p><ul><li><strong>Trade data</strong>: ~25,000 records per day (~8 trades every 10 seconds)</li><li><strong>LoB data</strong>: ~210,000 records per day (~750 snapshots every 10 seconds)</li></ul><p>This means we see, on average, <strong>10 order book updates for each trade</strong>. During high-volatility periods, there can be up to <strong>14 trades per second</strong>, making this dataset quite dense.
Given this volume we can not visualise everything at once. The most obvious next step is to look at it in a summarised form, then drill down wherever it makes sense. But before we do that, we need to answer what is worth looking at? Where to start?
The goal of any EDA visualisation should be to answer one or a set of questions that align to an end goal. The end goal of this project is to identify trading signals, so the questions we need to answer should be aligned to that. To do that, we need to understand how did the price of this stock grow/fall with time, was this growth or fall natural or something else resulted it? What are those factors that could have resulted in this price movement? What was the market sentiment during this period? How did the traders react to this price movement? Did they buy or sell? Did they panic or were they confident?</p><h3 id=ohlc-summary-a-natural-starting-point>OHLC Summary: A Natural Starting Point</h3><p>The first question is easier to answer, we start by looking at the price trend using OHLC(Open-High-Low-Close) plot. As the name suggest it is the - Opening, Highest, Lowest and Closing prices per day. To see trader&rsquo;s behaviour during the price movement its work complementing this plot with traded volumes(this touches the last set of questions). In the six months the data covers, stock exchange was open for around 124 days, and our first visualization will be a daily OHLC candlestick plot to get a bird’s-eye view of price movements over time.</p><p><img src=/images/OHLC_vol_v2.png alt="OHLC Plot"></p><p><strong>February Peak (Max: 341)</strong></p><p>There are some powerful insights emerging from this visualisation. The chart shows a strong upwards price movement peaking at 341 mid-Feb, then onwards a consistent fall, indicating a catalyst-driven event(strong earning before calendar year end, news etc). Another important clue to pick here is the peak happened on 10th Feb, with this volume of data, if we were to sample days for a micro longitudinal analysis of features, 10th(or nearby) of every month would be a good candidate, it would capture the build-up and decay to-from the most relevant day. It also neighter falls at the beginning nor end of the month, so it is less likely to be affected by month-end effects.</p><p><strong>Bearish Trend Post-February</strong></p><p>Bearish Trend Post-February, this indicates a shift in market sentiment towards pessimism. Overall, the data suggests a complete market cycle from exuberance (Feb) to despair(June).</p><p><strong>Declining Volatility</strong></p><p>In the early period (Jan–Feb), <strong>candlesticks are longer</strong>, reflecting wider high-low spreads—i.e., <strong>greater intraday price movement</strong> (volatility). From <strong>March onwards</strong>, candles become shorter and more compressed, indicating reduced price movements and more <strong>ordered market behavior</strong>.</p><p><strong>Volume-Price Correlation (Negative)</strong></p><p>The volume bars and trend line on the secondary axis show increasing volume as the price falls—<strong>inverse volume-price correlation</strong>.</p><ul><li>This is often indicative of distribution phases where smart money is exiting positions while retail traders are still buying, or <strong>panic selling</strong> as prices decline.</li></ul><p>Now that we know what was happening with the actual trade price, we can get a deeper understanding of traders sentiments during this period using the Level 2 data, best bids and asks and the spread. The price increased during the begining of the time period, but we lack a wider picture of this stock, it hard to say if this price decline was an orderly price correction, with active trades and stable liquidity or something else. Therefore we look at the mean of daily best_bid, best_ask and spread for the same time period -</p><p><img src=/images/spread_6months.png alt="Spread Plot"></p><p>This plot reveals a complementory story to the OHLC plot, this shows that spread widened with price drop. This indicate that buyer confidence dropped and liquidity providers pulled back(overall confidence in traders in this stock dropped consistently). This indicate that Spread could be a strong indicator of market sentiment.</p><p>There is also a broader insight that gleans through this observation which is the increase in execution risk - high spread indicates that buyers and sellers are not setteling on trades easily. This means that even if we predict direction of price movement the orders may not necessarily get executed quickly or at the expected price, making profitability difficult. Interestingly, the rise in trade volume as price went down is likely due to panic selling or forced liquidation. In fact, the widening spread suggests that while more trades are happening, they are doing so at increasingly unfavorable terms.</p><p>These two plots together gives a combined view of price, volume and spread and reveals a broader picutre of the market sentiment transitioning from confidence to panic during the six months. The price decline with rising volumes and widening spreads indicates not just a bearish trend but also a <strong>liquidity crisis</strong>. If we were to categorize, it is possible that most of the trades during the period after march would be classified as &lsquo;Sell&rsquo;(if you are interested in validating this hypothesis you can use lee-ready algorithm to classify trades).</p><p>With this broader understanding we can move on to the next set of questions relevant to our primary goal of extracting predictive signals for price movement. There can me many such questions a few that i could come up with - Do the traders quote reactively or anticipate price movements? This would suggest orderbook itself holds strong predictive value. Is there a persistent imbalance in bid and ask volumes, if it is, does it precedes price movement? Imbalance might provide directional intent. Are most orders executing from the top levels or there is slippage(top level doesnt have enough volume)? this is improtant to understand the short term price movements. How far are executed trades from mid-price? if trades are closer to bid price this would indicate that traders are cautious this may have directional indication for price going down. Also, before a significant price movements, do we see a change in order book? This would indicate that traders are using order book as a signal to trade for eg: concentration of orders at a specific price level, or a large order eating liquidity etc.</p><p>Answering these questions may give us features that can inform our model for possible price movements. So the next step is to look at the order book data and see if we can find any patterns that can help us answer these questions.</p><h3 id=order-book-analysis>Order Book Analysis:</h3><p>There are broadly two types of studies we can perform on the order book data - one</p><ul class=pa0></ul><div class="mt6 instapaper_ignoref"><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//honeyhsc.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div><aside class="w-30-l mt6-l"></aside></article></main><footer class="bg-black bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white white-70 dn dib-ns pv2 ph3 no-underline" href=https://honeyhsc.github.io/>&copy; Honey's Data Science Portfolio 2025</a><div><div class=ananke-socials><a href=https://th.linkedin.com/in/honey-schauhan/ target=_blank rel=noopener class="ananke-social-link link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="follow on LinkedIn - Opens in a new window" aria-label="follow on LinkedIn - Opens in a new window"><span class=icon><svg viewBox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg>
</span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a></div></div></div></footer></body></html>